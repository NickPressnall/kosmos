#!/usr/bin/env ruby

require 'kosmos'

case ARGV.shift
when 'init'
  ksp_path = ARGV.shift

  puts "Initializing Kosmos into #{ksp_path} (This will take a sec) ..."

  Kosmos::Versioner.init_repo(ksp_path)
  Kosmos.save_ksp_path(ksp_path)

  puts "Done! You're ready to begin installing mods."
  puts
  puts "Install your first mod by running the command:"
  puts "  kosmos install [name-of-the-mod]"
  puts

when 'install'
  package_name = ARGV.shift
  ksp_path = Kosmos.load_ksp_path

  package = Kosmos::Package.find(package_name)
  puts "Installing package #{package.title} ..."

  package.new.install!(ksp_path)

  puts "Done!"

when 'uninstall'
  ksp_path = Kosmos.load_ksp_path

  puts "Preparing to uninstall the most recently-installed mod ..."
  package = Kosmos::Versioner.uninstall_last_package(ksp_path)
  puts "Done! Just uninstalled: #{package}."

when 'list'
  ksp_path = Kosmos.load_ksp_path

  packages = Kosmos::Versioner.installed_packages(ksp_path)
  puts "You have installed #{packages.length} mod(s) using Kosmos:"

  packages.each do |package|
    puts "  * #{package}"
  end
end
